@model IEnumerable<Barabas.Models.Event>
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

@{
    ViewData["Title"] = "Event Management";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container my-5">
    <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-3">
        <div>
            <h1 class="fw-bold text-primary mb-0">🎪 Event Management</h1>
            <p class="text-muted mb-0">Manage, edit, and track your upcoming and past events.</p>
        </div>

        <a asp-action="Create" class="btn btn-success btn-lg rounded-pill px-4 shadow-sm">
            <i class="bi bi-plus-lg"></i> Create New Event
        </a>
    </div>

    <div class="table-responsive shadow-sm rounded-4 bg-white p-3">
        <table class="table table-hover align-middle mb-0">
            <thead class="table-primary">
                <tr>
                    <th>Preview</th>
                    <th>Name</th>
                    <th>Location</th>
                    <th>Date</th>
                    <th>Category</th>
                    <th>Price</th>
                    <th>Status</th>
                    <th style="width: 180px;">Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model.OrderByDescending(e => e.Date))
                {
                    var isPast = item.Date < DateTime.Now;
                    <tr class="@(isPast ? "text-muted bg-light" : "")">
                        <td>
                            <img src="@item.Image" alt="@item.Name"
                                 style="width: 70px; height: 70px; object-fit: cover; border-radius: 10px;">
                        </td>
                        <td class="fw-semibold">@item.Name</td>
                        <td><i class="bi bi-geo-alt-fill text-primary"></i> @item.Location</td>
                        <td>@item.Date.ToString("dd MMM yyyy, HH:mm")</td>
                        <td><span class="badge bg-info text-dark">#@item.EventCategoryId</span></td>
                        <td><strong>@item.Price.ToString("0.00") ₴</strong></td>
                        <td>
                            @if (isPast)
                            {
                                <span class="badge bg-secondary">Ended</span>
                            }
                            else if (item.Date.Date == DateTime.Today)
                            {
                                <span class="badge bg-warning text-dark">Today</span>
                            }
                            else
                            {
                                <span class="badge bg-success">Upcoming</span>
                            }
                        </td>
                        <td>
                            <div class="btn-group" role="group">
                                <a asp-action="Details" asp-route-id="@item.Id"
                                   class="btn btn-outline-primary btn-sm px-3">
                                    <i class="bi bi-eye"></i>
                                </a>
                                <a asp-action="Edit" asp-route-id="@item.Id"
                                   class="btn btn-outline-warning btn-sm px-3">
                                    <i class="bi bi-pencil"></i>
                                </a>
                                <a asp-action="Delete" asp-route-id="@item.Id"
                                   class="btn btn-outline-danger btn-sm px-3"
                                   onclick="return confirm('Are you sure you want to delete this event?');">
                                    <i class="bi bi-trash"></i>
                                </a>
                            </div>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<style>
    body {
        background-color: #f4f7fb;
    }

    .table {
        border-radius: 12px;
        overflow: hidden;
    }

        .table th {
            white-space: nowrap;
            vertical-align: middle;
        }

        .table td {
            vertical-align: middle;
        }

    .btn-group .btn {
        border-radius: 6px !important;
    }

    .btn-outline-primary:hover {
        background-color: #007bff;
        color: #fff;
    }

    .btn-outline-warning:hover {
        background-color: #ffc107;
        color: #000;
    }

    .btn-outline-danger:hover {
        background-color: #dc3545;
        color: #fff;
    }

    .table-hover tbody tr:hover {
        background-color: #f8f9fa;
        transform: scale(1.01);
        transition: all 0.2s ease;
    }

    .table-primary th {
        color: #003366;
        font-weight: 600;
        text-transform: uppercase;
    }
</style>
